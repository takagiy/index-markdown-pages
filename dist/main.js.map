{"version":3,"sources":["../src/main.ts"],"sourcesContent":["import { setFailed } from \"@actions/core\";\nimport { globbyStream } from \"globby\";\nimport { ChildDocuments } from \"./ChilidDocuments\";\nimport { Document } from \"./Document\";\nimport { Inputs } from \"./Inputs\";\n\nexport async function run(): Promise<void> {\n  try {\n    const inputs = Inputs.get();\n    const rootDocuments = searchRootDocuments(inputs.rootPatterns);\n\n    for await (const rootDocument of rootDocuments) {\n      const childDocuments = await ChildDocuments.search(rootDocument);\n      const indexBlock = childDocuments.toIndexBlock(inputs.header);\n      const document = await Document.open(rootDocument);\n      document.replaceOrAppend(indexBlock);\n      await document.save();\n    }\n  } catch (error) {\n    if (error instanceof Error) setFailed(error.message);\n  }\n}\n\nasync function* searchRootDocuments(rootPatterns: string[]) {\n  for await (const rootDocument of globbyStream(rootPatterns)) {\n    yield rootDocument.toString();\n  }\n}\n"],"names":["run","inputs","Inputs","get","rootDocuments","searchRootDocuments","rootPatterns","rootDocument","childDocuments","ChildDocuments","search","indexBlock","toIndexBlock","header","document","Document","open","replaceOrAppend","save","error","Error","setFailed","message","globbyStream","toString"],"mappings":";;;;+BAMsBA;;;eAAAA;;;sBANI;wBACG;iCACE;0BACN;wBACF;AAEhB,eAAeA;IACpB,IAAI;QACF,MAAMC,SAASC,cAAM,CAACC,GAAG;QACzB,MAAMC,gBAAgBC,oBAAoBJ,OAAOK,YAAY;QAE7D,WAAW,MAAMC,gBAAgBH,cAAe;YAC9C,MAAMI,iBAAiB,MAAMC,+BAAc,CAACC,MAAM,CAACH;YACnD,MAAMI,aAAaH,eAAeI,YAAY,CAACX,OAAOY,MAAM;YAC5D,MAAMC,WAAW,MAAMC,kBAAQ,CAACC,IAAI,CAACT;YACrCO,SAASG,eAAe,CAACN;YACzB,MAAMG,SAASI,IAAI;QACrB;IACF,EAAE,OAAOC,OAAO;QACd,IAAIA,iBAAiBC,OAAOC,IAAAA,eAAS,EAACF,MAAMG,OAAO;IACrD;AACF;AAEA,gBAAgBjB,oBAAoBC,YAAsB;IACxD,WAAW,MAAMC,gBAAgBgB,IAAAA,oBAAY,EAACjB,cAAe;QAC3D,MAAMC,aAAaiB,QAAQ;IAC7B;AACF"}